<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Python &mdash; Rascal 0.0.1 documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="shortcut icon" href="../_static/rascal.png"/>
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="C++ documentation" href="cpp.html" />
    <link rel="prev" title="API reference" href="index.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Rascal
          </a>
              <div class="version">
                0.0.1
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../user_guide/user_guide.html">User’s Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../examples/examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../whitepaper.html">Goals &amp; Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../SOAP.html">SOAP Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dev_guide/developer.html">Developer’s guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">API reference</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Python</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#atoms-and-cells">Atoms and cells</a></li>
<li class="toctree-l3"><a class="reference internal" href="#representations">Representations</a></li>
<li class="toctree-l3"><a class="reference internal" href="#models">Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#filters">Filters</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#io">IO</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cpp.html">C++ documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Rascal</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="index.html">API reference</a> &raquo;</li>
      <li>Python</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/reference/python.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="python">
<span id="auto-python"></span><h1>Python<a class="headerlink" href="#python" title="Permalink to this headline"></a></h1>
<p>This list is incomplete. You can help by <em>expanding it</em>!</p>
<section id="atoms-and-cells">
<h2>Atoms and cells<a class="headerlink" href="#atoms-and-cells" title="Permalink to this headline"></a></h2>
<p>Some base functionality for working with structures and collections thereof in
<code class="docutils literal notranslate"><span class="pre">librascal</span></code></p>
<dl class="py class">
<dt class="sig sig-object py" id="rascal.neighbourlist.structure_manager.AtomsList">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">rascal.neighbourlist.structure_manager.</span></span><span class="sig-name descname"><span class="pre">AtomsList</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nl_options</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">start</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">length</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">managers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rascal/neighbourlist/structure_manager.html#AtomsList"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rascal.neighbourlist.structure_manager.AtomsList" title="Permalink to this definition"></a></dt>
<dd><p>A container for the neighbourlist and representation data associated with a list of atomic structures.</p>
<p>This is a wrapper class for the <cite>StructureManagerCollection</cite> that have between precompiled on the C++ side.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.neighbourlist.structure_manager.AtomsList.nl_options">
<span class="sig-name descname"><span class="pre">nl_options</span></span><a class="headerlink" href="#rascal.neighbourlist.structure_manager.AtomsList.nl_options" title="Permalink to this definition"></a></dt>
<dd><p>Parameters for each layer of the wrapped structure manager. Parameters
can be specified for these layers: center, neighbourlist and strict.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.neighbourlist.structure_manager.AtomsList.managers">
<span class="sig-name descname"><span class="pre">managers</span></span><a class="headerlink" href="#rascal.neighbourlist.structure_manager.AtomsList.managers" title="Permalink to this definition"></a></dt>
<dd><p>C++ object from rascal that holds the neighbourlist and the data associated with representations.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>StructureManagerCollection</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rascal.neighbourlist.structure_manager.mask_center_atoms_by_id">
<span class="sig-prename descclassname"><span class="pre">rascal.neighbourlist.structure_manager.</span></span><span class="sig-name descname"><span class="pre">mask_center_atoms_by_id</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_select</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">id_blacklist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rascal/neighbourlist/structure_manager.html#mask_center_atoms_by_id"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rascal.neighbourlist.structure_manager.mask_center_atoms_by_id" title="Permalink to this definition"></a></dt>
<dd><p>Mask the centers (center-select) of an ASE atoms object, by index</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frame</strong> (<em>ase.Atoms</em>) – Atomic structure to mask</p></li>
<li><p><strong>id_select</strong> (<em>list of int</em>) – List of atom IDs to select</p></li>
<li><p><strong>id_blacklist</strong> (<em>list of int</em>) – List of atom IDs to exclude</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None (the Atoms object is modified directly)</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The default is to select all atoms.  If <cite>id_select</cite> is provided,
select only those atoms.  If only <cite>id_blacklist</cite> is provided, select
all atoms <em>except</em> those in the blacklist.  If both are provided,
atoms are first selected based on <cite>id_select</cite> and then excluded based
on <cite>id_blacklist</cite>.  If the atoms object already has a mask, then
<cite>id_select</cite> is applied first using the <cite>or</cite> operation, then
<cite>id_blacklist</cite> is applied using the <cite>and not</cite> operation (so the order
of precedence is: blacklist, selection, previous mask).</p>
<p>This logic allows this function to be combined with
<cite>mask_center_atoms_by_species</cite> to allow mixed species/id-based
masking.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rascal.neighbourlist.structure_manager.mask_center_atoms_by_species">
<span class="sig-prename descclassname"><span class="pre">rascal.neighbourlist.structure_manager.</span></span><span class="sig-name descname"><span class="pre">mask_center_atoms_by_species</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species_select</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">species_blacklist</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rascal/neighbourlist/structure_manager.html#mask_center_atoms_by_species"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rascal.neighbourlist.structure_manager.mask_center_atoms_by_species" title="Permalink to this definition"></a></dt>
<dd><p>Mask the centers of an ASE atoms object, by atomic species</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frame</strong> (<em>ase.Atoms</em>) – Atomic structure to mask</p></li>
<li><p><strong>species_select</strong> (<em>list of int</em><em> or </em><em>str</em>) – List of atomic numbers, or species symbols, to select.
Should be of consistent type across list.</p></li>
<li><p><strong>species_blacklist</strong> (<em>list of int</em><em> or </em><em>str</em>) – List of atomic numbers, or species symbols, to exclude.
Should be of consistent type across list.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>None (the Atoms object is modified directly)</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The default is to select all atoms.  If <cite>species_select</cite> is
provided, select only those atoms whose species is in the list.  If
only <cite>species_blacklist</cite> is provided, select all atoms <em>except</em>
those whose species is in the blacklist.  If both are provided,
atoms are first selected based on <cite>species_select</cite> and then excluded
based on <cite>species_blacklist</cite>.  If the atoms object already has a
mask, then <cite>species_select</cite> is applied first using the <cite>or</cite>
operation, then <cite>species_blacklist</cite> is applied using the <cite>and not</cite>
operation (so the order of precedence is: blacklist, selection,
previous mask).</p>
<p>This logic allows this function to be combined with
<cite>mask_center_atoms_by_id</cite> to allow mixed species/id-based masking.</p>
</dd></dl>

</section>
<section id="representations">
<h2>Representations<a class="headerlink" href="#representations" title="Permalink to this headline"></a></h2>
<p>Representations are the primary classes in <code class="docutils literal notranslate"><span class="pre">librascal</span></code> used to compute
structural representations (features, descriptors) from a list of atoms.</p>
<dl class="py class">
<dt class="sig sig-object py" id="rascal.representations.SortedCoulombMatrix">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">rascal.representations.</span></span><span class="sig-name descname"><span class="pre">SortedCoulombMatrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sorting_algorithm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'row_norm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">central_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interaction_cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interaction_decay</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rascal/representations/coulomb_matrix.html#SortedCoulombMatrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rascal.representations.SortedCoulombMatrix" title="Permalink to this definition"></a></dt>
<dd><p>Computes the Sorted Coulomb matrix representation [1].</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SortedCoulombMatrix.cutoff">
<span class="sig-name descname"><span class="pre">cutoff</span></span><a class="headerlink" href="#rascal.representations.SortedCoulombMatrix.cutoff" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SortedCoulombMatrix.central_decay">
<span class="sig-name descname"><span class="pre">central_decay</span></span><a class="headerlink" href="#rascal.representations.SortedCoulombMatrix.central_decay" title="Permalink to this definition"></a></dt>
<dd><p>The distance over which the the coulomb interaction decays from full to none.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SortedCoulombMatrix.interaction_cutoff">
<span class="sig-name descname"><span class="pre">interaction_cutoff</span></span><a class="headerlink" href="#rascal.representations.SortedCoulombMatrix.interaction_cutoff" title="Permalink to this definition"></a></dt>
<dd><p>The distance between two non-central atom, where the coulomb interaction element will be zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SortedCoulombMatrix.interaction_decay">
<span class="sig-name descname"><span class="pre">interaction_decay</span></span><a class="headerlink" href="#rascal.representations.SortedCoulombMatrix.interaction_decay" title="Permalink to this definition"></a></dt>
<dd><p>The distance over which the the coulomb interaction decays from full to none.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SortedCoulombMatrix.size">
<span class="sig-name descname"><span class="pre">size</span></span><a class="headerlink" href="#rascal.representations.SortedCoulombMatrix.size" title="Permalink to this definition"></a></dt>
<dd><p>Larger or equal to the maximum number of neighbour an atom has in the structure.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rascal.representations.SortedCoulombMatrix.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frames</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rascal/representations/coulomb_matrix.html#SortedCoulombMatrix.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rascal.representations.SortedCoulombMatrix.transform" title="Permalink to this definition"></a></dt>
<dd><p>Compute the representation for a list of ase.Atoms object.</p>
</dd></dl>

<dl class="footnote brackets">
<dt class="label" id="id1"><span class="brackets">1</span></dt>
<dd><p>Rupp, M., Tkatchenko, A., Müller, K.-R., &amp; von Lilienfeld, O. A. (2011).
Fast and Accurate Modeling of Molecular Atomization Energies with Machine Learning.
Physical Review Letters, 108(5), 58301. <a class="reference external" href="https://doi.org/10.1103/PhysRevLett.108.058301">https://doi.org/10.1103/PhysRevLett.108.058301</a></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="id0">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frames</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rascal/representations/coulomb_matrix.html#SortedCoulombMatrix.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id0" title="Permalink to this definition"></a></dt>
<dd><p>Compute the representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>frames</strong> (<em>list</em><em>(</em><em>ase.Atoms</em><em>) or </em><a class="reference internal" href="#rascal.neighbourlist.structure_manager.AtomsList" title="rascal.neighbourlist.structure_manager.AtomsList"><em>AtomsList</em></a>) – List of atomic structures.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>AtomsList</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Object containing the representation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rascal.representations.SortedCoulombMatrix.update_hyperparameters">
<span class="sig-name descname"><span class="pre">update_hyperparameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">hypers</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rascal/representations/coulomb_matrix.html#SortedCoulombMatrix.update_hyperparameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rascal.representations.SortedCoulombMatrix.update_hyperparameters" title="Permalink to this definition"></a></dt>
<dd><p>Store the given dict of hyperparameters</p>
<p>Also updates the internal json-like representation</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="rascal.representations.SphericalInvariants">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">rascal.representations.</span></span><span class="sig-name descname"><span class="pre">SphericalInvariants</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interaction_cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_smooth_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_radial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_angular</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaussian_sigma_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaussian_sigma_constant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_function_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ShiftedCosine'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soap_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'PowerSpectrum'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inversion_symmetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radial_basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GTO'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">expansion_by_species_method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'environment</span> <span class="pre">wise'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_species</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_gradients</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_function_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coefficient_subselection</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rascal/representations/spherical_invariants.html#SphericalInvariants"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rascal.representations.SphericalInvariants" title="Permalink to this definition"></a></dt>
<dd><p>Computes a SphericalInvariants representation, i.e. the SOAP power spectrum.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SphericalInvariants.interaction_cutoff">
<span class="sig-name descname"><span class="pre">interaction_cutoff</span></span><a class="headerlink" href="#rascal.representations.SphericalInvariants.interaction_cutoff" title="Permalink to this definition"></a></dt>
<dd><p>Maximum pairwise distance for atoms to be considered in
expansion</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SphericalInvariants.cutoff_smooth_width">
<span class="sig-name descname"><span class="pre">cutoff_smooth_width</span></span><a class="headerlink" href="#rascal.representations.SphericalInvariants.cutoff_smooth_width" title="Permalink to this definition"></a></dt>
<dd><p>The distance over which the the interaction is smoothed to zero</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SphericalInvariants.max_radial">
<span class="sig-name descname"><span class="pre">max_radial</span></span><a class="headerlink" href="#rascal.representations.SphericalInvariants.max_radial" title="Permalink to this definition"></a></dt>
<dd><p>Number of radial basis functions</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SphericalInvariants.max_angular">
<span class="sig-name descname"><span class="pre">max_angular</span></span><a class="headerlink" href="#rascal.representations.SphericalInvariants.max_angular" title="Permalink to this definition"></a></dt>
<dd><p>Highest angular momentum number (l) in the expansion</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SphericalInvariants.gaussian_sigma_type">
<span class="sig-name descname"><span class="pre">gaussian_sigma_type</span></span><a class="headerlink" href="#rascal.representations.SphericalInvariants.gaussian_sigma_type" title="Permalink to this definition"></a></dt>
<dd><p>How the Gaussian atom sigmas (smearing widths) are allowed to
vary. Only fixed smearing width (‘Constant’) are implemented.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SphericalInvariants.gaussian_sigma_constant">
<span class="sig-name descname"><span class="pre">gaussian_sigma_constant</span></span><a class="headerlink" href="#rascal.representations.SphericalInvariants.gaussian_sigma_constant" title="Permalink to this definition"></a></dt>
<dd><p>Specifies the atomic Gaussian widths, in the case where they’re
fixed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SphericalInvariants.cutoff_function_type">
<span class="sig-name descname"><span class="pre">cutoff_function_type</span></span><a class="headerlink" href="#rascal.representations.SphericalInvariants.cutoff_function_type" title="Permalink to this definition"></a></dt>
<dd><p>Choose the type of smooth cutoff function used to define the local
environment. Can be either ‘ShiftedCosine’ or ‘RadialScaling’.</p>
<p>If ‘ShiftedCosine’, the functional form of the switching function is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}sc(r) = \begin{cases}
1 &amp;r &lt; r_c - sw,\\
0.5 + 0.5 \cos(\pi * (r - r_c + sw) / sw) &amp;r_c - sw &lt; r &lt;= r_c, \\
0 &amp;r_c &lt; r,
\end{cases}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(r_c\)</span> is the interaction_cutoff and <span class="math notranslate nohighlight">\(sw\)</span> is the
cutoff_smooth_width.</p>
<p>If ‘RadialScaling’, the functional form of the switching function is
as expressed in equation 21 of <a class="reference external" href="https://doi.org/10.1039/c8cp05921g">https://doi.org/10.1039/c8cp05921g</a>:</p>
<div class="math notranslate nohighlight">
\[rs(r) = sc(r) u(r),\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}u(r) = \begin{cases}
\frac{1}{(r/r_0)^m} &amp;\text{if c=0,}\\
1 &amp;\text{if m=0,} \\
\frac{c}{c+(r/r_0)^m} &amp;\text{else},
\end{cases}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(c\)</span> is the rate, <span class="math notranslate nohighlight">\(r_0\)</span> is the scale, <span class="math notranslate nohighlight">\(m\)</span> is the
exponent.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SphericalInvariants.soap_type">
<span class="sig-name descname"><span class="pre">soap_type</span></span><a class="headerlink" href="#rascal.representations.SphericalInvariants.soap_type" title="Permalink to this definition"></a></dt>
<dd><p>Specifies the type of representation to be computed
(“RadialSpectrum”, “PowerSpectrum” and “BiSpectrum”).</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SphericalInvariants.inversion_symmetry">
<span class="sig-name descname"><span class="pre">inversion_symmetry</span></span><a class="headerlink" href="#rascal.representations.SphericalInvariants.inversion_symmetry" title="Permalink to this definition"></a></dt>
<dd><p>Specifies whether inversion invariance should be enforced.
(Only relevant for BiSpectrum.)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>boolean</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SphericalInvariants.radial_basis">
<span class="sig-name descname"><span class="pre">radial_basis</span></span><a class="headerlink" href="#rascal.representations.SphericalInvariants.radial_basis" title="Permalink to this definition"></a></dt>
<dd><p>Specifies the type of radial basis R_n to be computed
(“GTO” for Gaussian typed orbitals and “DVR” discrete variable
representation using Gaussian-Legendre quadrature rule)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SphericalInvariants.normalize">
<span class="sig-name descname"><span class="pre">normalize</span></span><a class="headerlink" href="#rascal.representations.SphericalInvariants.normalize" title="Permalink to this definition"></a></dt>
<dd><p>Whether to normalize so that the kernel between identical environments
is 1.  Default and highly recommended: True.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>boolean</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SphericalInvariants.optimization">
<span class="sig-name descname"><span class="pre">optimization</span></span><a class="headerlink" href="#rascal.representations.SphericalInvariants.optimization" title="Permalink to this definition"></a></dt>
<dd><p>Optional arguments for optimization of the computation of spherical
expansion coefficients. “Spline” and “RadialDimReduction” are available.</p>
<p>Spline: Enables cubic splining for the radial basis functions.</p>
<blockquote>
<div><dl class="simple">
<dt>accuracy<span class="classifier">float</span></dt><dd><p>accuracy of the cubic spline</p>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>RadialDimReduction: Projection matrices to optimize radial basis,</dt><dd><blockquote>
<div><p>requires Spline to be set</p>
</div></blockquote>
<dl class="simple">
<dt>projection_matrices<span class="classifier">dict</span></dt><dd><p>Contains or each species a list of projection matrices for each
angular channel. A projection matrix for an angular channel has
the shape (max_radial, expanded_max_radial). A number of
<cite>expanded_max_radial</cite> radial basis are computed
to be then projected to <cite>max_radial</cite> radial basis. The projected
radial basis is then splined for each species and angular channel</p>
</dd>
</dl>
</dd>
</dl>
<p>Default settings is using spline</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict, default None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SphericalInvariants.expansion_by_species_method">
<span class="sig-name descname"><span class="pre">expansion_by_species_method</span></span><a class="headerlink" href="#rascal.representations.SphericalInvariants.expansion_by_species_method" title="Permalink to this definition"></a></dt>
<dd><p>Specifies the how the species key of the invariant are set-up.
Possible values: ‘environment wise’, ‘user defined’, ‘structure wise’.
The descriptor is computed for each atomic enviroment and it is indexed
using tuples of atomic species that are present within the environment.
This index is by definition sparse since a species tuple will be non
zero only if the atomic species are present inside the environment.
‘environment wise’ means that each environmental representation
will only contain the minimal set of species tuples needed by each
atomic environment.
‘structure wise’ means that within a structure the species tuples
will be the same for each environment coefficients.
‘user defined’ uses global_species to set-up the species tuples.</p>
<p>These different settings correspond to different trade-off between
the memory efficiency of the invariants and the computational
efficiency of the kernel computation.
When computing a kernel using ‘environment wise’ setting does not allow
for efficent matrix matrix multiplications which is ensured when
‘user defined’ is used. ‘structure wise’ is a balance between the
memory footprint and the use of matrix matrix products.</p>
<p>Note that the sparsity of the gradient coefficients and their use to
build kernels does not allow for clear efficiency gains so their
sparsity is kept irrespective of expansion_by_species_method.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SphericalInvariants.global_species">
<span class="sig-name descname"><span class="pre">global_species</span></span><a class="headerlink" href="#rascal.representations.SphericalInvariants.global_species" title="Permalink to this definition"></a></dt>
<dd><p>list of species (specified with their atomic number) to use to set-up
the species key of the invariant. It should contain all the species
present in the structure for which invariants will be computed</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list of int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SphericalInvariants.compute_gradients">
<span class="sig-name descname"><span class="pre">compute_gradients</span></span><a class="headerlink" href="#rascal.representations.SphericalInvariants.compute_gradients" title="Permalink to this definition"></a></dt>
<dd><p>control the computation of the representation’s gradients w.r.t. atomic
positions.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SphericalInvariants.cutoff_function_parameters">
<span class="sig-name descname"><span class="pre">cutoff_function_parameters</span></span><a class="headerlink" href="#rascal.representations.SphericalInvariants.cutoff_function_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Additional parameters for the cutoff function.
if cutoff_function_type == ‘RadialScaling’ then it should have the form</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">dict</span><span class="p">(</span><span class="n">rate</span><span class="o">=...</span><span class="p">,</span>
     <span class="n">scale</span><span class="o">=...</span><span class="p">,</span>
     <span class="n">exponent</span><span class="o">=...</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="code docutils literal notranslate"><span class="pre">...</span></code> should be replaced by the desired positive float.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SphericalInvariants.coefficient_subselection">
<span class="sig-name descname"><span class="pre">coefficient_subselection</span></span><a class="headerlink" href="#rascal.representations.SphericalInvariants.coefficient_subselection" title="Permalink to this definition"></a></dt>
<dd><p>if None then all the coefficients are computed following max_radial,
max_angular and the atomic species present.
if <code class="code docutils literal notranslate"><span class="pre">soap_type</span> <span class="pre">==</span> <span class="pre">'PowerSpectrum'</span></code> and it has the form
<code class="code docutils literal notranslate"><span class="pre">{'a':</span> <span class="pre">[...],</span> <span class="pre">'b':</span> <span class="pre">[...],</span> <span class="pre">'n1':</span> <span class="pre">[...],</span> <span class="pre">'n2':</span> <span class="pre">[...],</span> <span class="pre">'l':</span> <span class="pre">[...]}</span></code>
where ‘a’ and ‘b’ are lists of atomic species, ‘n1’ and ‘n2’ are lists
of radial expension indices and ‘l’ is the list of spherical expansion
index. Each of these lists have the same size and their ith element
refers to one PowerSpectrum coefficient that will be computed.
<code class="xref py py-class docutils literal notranslate"><span class="pre">utils.FPSFilter</span></code> and <code class="xref py py-class docutils literal notranslate"><span class="pre">utils.CURFilter</span></code> with
<cite>act_on</cite> set to <cite>feature</cite> output such dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>list or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rascal.representations.SphericalInvariants.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frames</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rascal/representations/spherical_invariants.html#SphericalInvariants.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rascal.representations.SphericalInvariants.transform" title="Permalink to this definition"></a></dt>
<dd><p>Compute the representation for a list of ase.Atoms object.</p>
</dd></dl>

<dl class="citation">
<dt class="label" id="soap"><span class="brackets">soap</span></dt>
<dd><p>Bartók, Kondor, and Csányi, “On representing chemical
environments”, Phys. Rev. B. 87(18), p. 184115
<a class="reference external" href="http://link.aps.org/doi/10.1103/PhysRevB.87.184115">http://link.aps.org/doi/10.1103/PhysRevB.87.184115</a></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="rascal.representations.SphericalInvariants.get_keys">
<span class="sig-name descname"><span class="pre">get_keys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">species</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rascal/representations/spherical_invariants.html#SphericalInvariants.get_keys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rascal.representations.SphericalInvariants.get_keys" title="Permalink to this definition"></a></dt>
<dd><p>return the proper list of keys used to build the representation</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rascal.representations.SphericalInvariants.get_num_coefficients">
<span class="sig-name descname"><span class="pre">get_num_coefficients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_species</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rascal/representations/spherical_invariants.html#SphericalInvariants.get_num_coefficients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rascal.representations.SphericalInvariants.get_num_coefficients" title="Permalink to this definition"></a></dt>
<dd><p>Return the number of coefficients in the representation</p>
<p>(this is the descriptor size per atomic centre)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id2">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frames</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rascal/representations/spherical_invariants.html#SphericalInvariants.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id2" title="Permalink to this definition"></a></dt>
<dd><p>Compute the representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>frames</strong> (<em>list</em><em>(</em><em>ase.Atoms</em><em>) or </em><a class="reference internal" href="#rascal.neighbourlist.structure_manager.AtomsList" title="rascal.neighbourlist.structure_manager.AtomsList"><em>AtomsList</em></a>) – List of atomic structures.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>AtomsList</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Object containing the representation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rascal.representations.SphericalInvariants.update_hyperparameters">
<span class="sig-name descname"><span class="pre">update_hyperparameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">hypers</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rascal/representations/spherical_invariants.html#SphericalInvariants.update_hyperparameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rascal.representations.SphericalInvariants.update_hyperparameters" title="Permalink to this definition"></a></dt>
<dd><p>Store the given dict of hyperparameters</p>
<p>Also updates the internal json-like representation</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="rascal.representations.SphericalCovariants">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">rascal.representations.</span></span><span class="sig-name descname"><span class="pre">SphericalCovariants</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">interaction_cutoff</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_smooth_width</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_radial</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_angular</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaussian_sigma_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gaussian_sigma_constant</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_function_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'ShiftedCosine'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">radial_basis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'GTO'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">optimization_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soap_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'LambdaSpectrum'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inversion_symmetry</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">covariant_lambda</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff_function_parameters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rascal/representations/spherical_covariants.html#SphericalCovariants"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rascal.representations.SphericalCovariants" title="Permalink to this definition"></a></dt>
<dd><p>Computes a SphericalCovariants representation, i.e. lambda spectrum.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SphericalCovariants.interaction_cutoff">
<span class="sig-name descname"><span class="pre">interaction_cutoff</span></span><a class="headerlink" href="#rascal.representations.SphericalCovariants.interaction_cutoff" title="Permalink to this definition"></a></dt>
<dd><p>Maximum pairwise distance for atoms to be considered in
expansion</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SphericalCovariants.cutoff_smooth_width">
<span class="sig-name descname"><span class="pre">cutoff_smooth_width</span></span><a class="headerlink" href="#rascal.representations.SphericalCovariants.cutoff_smooth_width" title="Permalink to this definition"></a></dt>
<dd><p>The distance over which the the interaction is smoothed to zero</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SphericalCovariants.max_radial">
<span class="sig-name descname"><span class="pre">max_radial</span></span><a class="headerlink" href="#rascal.representations.SphericalCovariants.max_radial" title="Permalink to this definition"></a></dt>
<dd><p>Number of radial basis functions</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SphericalCovariants.max_angular">
<span class="sig-name descname"><span class="pre">max_angular</span></span><a class="headerlink" href="#rascal.representations.SphericalCovariants.max_angular" title="Permalink to this definition"></a></dt>
<dd><p>Highest angular momentum number (l) in the expansion</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SphericalCovariants.gaussian_sigma_type">
<span class="sig-name descname"><span class="pre">gaussian_sigma_type</span></span><a class="headerlink" href="#rascal.representations.SphericalCovariants.gaussian_sigma_type" title="Permalink to this definition"></a></dt>
<dd><p>How the Gaussian atom sigmas (smearing widths) are allowed to
vary. Only fixed smearing width (‘Constant’) are implemented.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SphericalCovariants.gaussian_sigma_constant">
<span class="sig-name descname"><span class="pre">gaussian_sigma_constant</span></span><a class="headerlink" href="#rascal.representations.SphericalCovariants.gaussian_sigma_constant" title="Permalink to this definition"></a></dt>
<dd><p>Specifies the atomic Gaussian widths, in the case where they’re
fixed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SphericalCovariants.cutoff_function_type">
<span class="sig-name descname"><span class="pre">cutoff_function_type</span></span><a class="headerlink" href="#rascal.representations.SphericalCovariants.cutoff_function_type" title="Permalink to this definition"></a></dt>
<dd><p>Choose the type of smooth cutoff function used to define the local
environment. Can be either ‘ShiftedCosine’ or ‘RadialScaling’.</p>
<p>If ‘ShiftedCosine’, the functional form of the switching function is:</p>
<div class="math notranslate nohighlight">
\[\begin{split}sc(r) = \begin{cases}
1 &amp;r &lt; r_c - sw,\\
0.5 + 0.5 \cos(\pi * (r - r_c + sw) / sw) &amp;r_c - sw &lt; r &lt;= r_c, \\
0 &amp;r_c &lt; r,
\end{cases}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(r_c\)</span> is the interaction_cutoff and <span class="math notranslate nohighlight">\(sw\)</span> is the
cutoff_smooth_width.</p>
<p>If ‘RadialScaling’, the functional form of the switching function is
as expressed in equation 21 of <a class="reference external" href="https://doi.org/10.1039/c8cp05921g">https://doi.org/10.1039/c8cp05921g</a>:</p>
<div class="math notranslate nohighlight">
\[rs(r) = sc(r) u(r),\]</div>
<p>where</p>
<div class="math notranslate nohighlight">
\[\begin{split}u(r) = \begin{cases}
\frac{1}{(r/r_0)^m} &amp;\text{if c=0,}\\
1 &amp;\text{if m=0,} \\
\frac{c}{c+(r/r_0)^m} &amp;\text{else},
\end{cases}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(c\)</span> is the rate, <span class="math notranslate nohighlight">\(r_0\)</span> is the scale, <span class="math notranslate nohighlight">\(m\)</span> is the
exponent.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SphericalCovariants.normalize">
<span class="sig-name descname"><span class="pre">normalize</span></span><a class="headerlink" href="#rascal.representations.SphericalCovariants.normalize" title="Permalink to this definition"></a></dt>
<dd><p>Whether to normalize so that the kernel between identical environments
is 1.  Default and highly recommended: True.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>boolean</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SphericalCovariants.radial_basis">
<span class="sig-name descname"><span class="pre">radial_basis</span></span><a class="headerlink" href="#rascal.representations.SphericalCovariants.radial_basis" title="Permalink to this definition"></a></dt>
<dd><p>Specifies the type of radial basis R_n to be computed
(“GTO” for Gaussian typed orbitals and “DVR” discrete variable
representation using Gauss-Legendre quadrature rule)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SphericalCovariants.soap_type">
<span class="sig-name descname"><span class="pre">soap_type</span></span><a class="headerlink" href="#rascal.representations.SphericalCovariants.soap_type" title="Permalink to this definition"></a></dt>
<dd><p>Specifies the type of representation to be computed.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>string</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SphericalCovariants.inversion_symmetry">
<span class="sig-name descname"><span class="pre">inversion_symmetry</span></span><a class="headerlink" href="#rascal.representations.SphericalCovariants.inversion_symmetry" title="Permalink to this definition"></a></dt>
<dd><p>Specifies whether inversion invariance should be enforced.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>boolean</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SphericalCovariants.covariant_lambda">
<span class="sig-name descname"><span class="pre">covariant_lambda</span></span><a class="headerlink" href="#rascal.representations.SphericalCovariants.covariant_lambda" title="Permalink to this definition"></a></dt>
<dd><p>Order of the lambda spectrum.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SphericalCovariants.cutoff_function_parameters">
<span class="sig-name descname"><span class="pre">cutoff_function_parameters</span></span><a class="headerlink" href="#rascal.representations.SphericalCovariants.cutoff_function_parameters" title="Permalink to this definition"></a></dt>
<dd><p>Additional parameters for the cutoff function.
if cutoff_function_type == ‘RadialScaling’ then it should have the form</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">dict</span><span class="p">(</span><span class="n">rate</span><span class="o">=...</span><span class="p">,</span>
     <span class="n">scale</span><span class="o">=...</span><span class="p">,</span>
     <span class="n">exponent</span><span class="o">=...</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="code docutils literal notranslate"><span class="pre">...</span></code> should be replaced by the desired positive float.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="rascal.representations.SphericalCovariants.optimization">
<span class="sig-name descname"><span class="pre">optimization</span></span><a class="headerlink" href="#rascal.representations.SphericalCovariants.optimization" title="Permalink to this definition"></a></dt>
<dd><p>Optional arguments for optimization of the computation of spherical
expansion coefficients. “Spline” and “RadialDimReduction” are available.</p>
<p>Spline: Enables cubic splining for the radial basis functions.</p>
<blockquote>
<div><dl class="simple">
<dt>accuracy<span class="classifier">float</span></dt><dd><p>accuracy of the cubic spline</p>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>RadialDimReduction: Projection matrices to optimize radial basis,</dt><dd><blockquote>
<div><p>requires Spline to be set</p>
</div></blockquote>
<dl class="simple">
<dt>projection_matrices<span class="classifier">dict</span></dt><dd><p>Contains or each species a list of projection matrices for each
angular channel. A projection matrix for an angular channel has
the shape (max_radial, expanded_max_radial). A number of
<cite>expanded_max_radial</cite> radial basis are computed
to be then projected to <cite>max_radial</cite> radial basis. The projected
radial basis is then splined for each species and angular channel</p>
</dd>
</dl>
</dd>
</dl>
<p>Default settings is using spline</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict, default None</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rascal.representations.SphericalCovariants.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frames</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rascal/representations/spherical_covariants.html#SphericalCovariants.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rascal.representations.SphericalCovariants.transform" title="Permalink to this definition"></a></dt>
<dd><p>Compute the representation for a list of ase.Atoms object.</p>
</dd></dl>

<dl class="citation">
<dt class="label" id="lambda-soap"><span class="brackets">lambda-soap</span></dt>
<dd><p>Grisafi, A., Wilkins, D. M., Csányi, G., &amp; Ceriotti, M.</p>
</dd>
</dl>
<p>(2018). Symmetry-Adapted Machine Learning for Tensorial Properties of
Atomistic Systems. Physical Review Letters, 120(3), 036002.
<a class="reference external" href="https://doi.org/10.1103/PhysRevLett.120.036002">https://doi.org/10.1103/PhysRevLett.120.036002</a></p>
<dl class="py method">
<dt class="sig sig-object py" id="rascal.representations.SphericalCovariants.get_keys">
<span class="sig-name descname"><span class="pre">get_keys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">species</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rascal/representations/spherical_covariants.html#SphericalCovariants.get_keys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rascal.representations.SphericalCovariants.get_keys" title="Permalink to this definition"></a></dt>
<dd><p>return the proper list of keys used to build the representation</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rascal.representations.SphericalCovariants.get_num_coefficients">
<span class="sig-name descname"><span class="pre">get_num_coefficients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n_species</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rascal/representations/spherical_covariants.html#SphericalCovariants.get_num_coefficients"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rascal.representations.SphericalCovariants.get_num_coefficients" title="Permalink to this definition"></a></dt>
<dd><p>Return the number of coefficients in the representation</p>
<p>(this is the descriptor size per atomic centre)</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="id3">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frames</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rascal/representations/spherical_covariants.html#SphericalCovariants.transform"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#id3" title="Permalink to this definition"></a></dt>
<dd><p>Compute the representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>frames</strong> (<em>list</em><em>(</em><em>ase.Atoms</em><em>) or </em><a class="reference internal" href="#rascal.neighbourlist.structure_manager.AtomsList" title="rascal.neighbourlist.structure_manager.AtomsList"><em>AtomsList</em></a>) – List of atomic structures.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>AtomsList</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Object containing the representation</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rascal.representations.SphericalCovariants.update_hyperparameters">
<span class="sig-name descname"><span class="pre">update_hyperparameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">hypers</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rascal/representations/spherical_covariants.html#SphericalCovariants.update_hyperparameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rascal.representations.SphericalCovariants.update_hyperparameters" title="Permalink to this definition"></a></dt>
<dd><p>Store the given dict of hyperparameters</p>
<p>Also updates the internal json-like representation</p>
</dd></dl>

</dd></dl>

</section>
<section id="models">
<h2>Models<a class="headerlink" href="#models" title="Permalink to this headline"></a></h2>
<p>Also included is an optimized implementation of kernel ridge regression (KRR,
also equivalent to Gaussian approximation potentials aka GAP).  Both fitting and
evaluating of models is implemented; the evaluation in particular is optimized
for use in MD simulations.</p>
<dl class="py class">
<dt class="sig sig-object py" id="rascal.models.Kernel">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">rascal.models.</span></span><span class="sig-name descname"><span class="pre">Kernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">representation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Cosine'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Full'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Structure'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rascal/models/kernels.html#Kernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rascal.models.Kernel" title="Permalink to this definition"></a></dt>
<dd><p>Initialize the kernel with the given representation and parameters</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>representation</strong> (<em>Calculator</em>) – Representation calculator associated with the kernel</p></li>
<li><p><strong>name</strong> (<em>string</em>) – Type of kernel, ‘Cosine’ (aka dot-product) is the default and
(currently) only option.</p></li>
<li><p><strong>target_type</strong> (<em>string</em>) – Type of target (prediction) properties, must be either ‘Atom’ (the kernel
is between atomic environments) or ‘Structure’ (the kernel is summed over
atoms in a structure), which is the default</p></li>
<li><p><strong>kernel_type</strong> (<em>string</em>) – Type of kernel method, either ‘Full’ (computing exact covariance matrix)
or ‘Sparse’ (computing GAP <a class="footnote-reference brackets" href="#id7" id="id4">2</a> like kernel for sparse kernel methods like
Subset of Regressors)</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>In the following
we refer to the training samples with ‘N’ and, in the case of
sparse kernels <a href="#id10"><span class="problematic" id="id5">[1]_</span></a>, we refer to the pseudo points with ‘M’. So a
kernel between the training samples and the pseudo points is
‘KNM’. For more information on sparse kernels see
<code class="xref py py-meth docutils literal notranslate"><span class="pre">rascal.models.krr.train_gap_model()</span></code>.</p>
<dl class="footnote brackets">
<dt class="label" id="id6"><span class="brackets">1</span></dt>
<dd><p>Joaquin Quiñonero-Candela, Carl Edward Rasmussen;
A Unifying View of Sparse Approximate Gaussian Process Regression,
6(Dec):1939–1959, 2005.
<a class="reference external" href="http://www.jmlr.org/papers/v6/quinonero-candela05a.html">http://www.jmlr.org/papers/v6/quinonero-candela05a.html</a></p>
</dd>
<dt class="label" id="id7"><span class="brackets"><a class="fn-backref" href="#id4">2</a></span></dt>
<dd><p>Ceriotti, M., Willatt, M. J., &amp; Csányi, G. (2018).</p>
</dd>
</dl>
<p>Machine Learning of Atomic-Scale Properties Based on Physical Principles.
In Handbook of Materials Modeling (pp. 1–27). Springer, Cham.
<a class="reference external" href="https://doi.org/10.1007/978-3-319-42913-7_68-1">https://doi.org/10.1007/978-3-319-42913-7_68-1</a></p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="rascal.models.KRR">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">rascal.models.</span></span><span class="sig-name descname"><span class="pre">KRR</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">weights</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_train</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">self_contributions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">description</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'KRR</span> <span class="pre">potential</span> <span class="pre">model'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rascal/models/krr.html#KRR"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rascal.models.KRR" title="Permalink to this definition"></a></dt>
<dd><p>Kernel Ridge Regression model. Only supports sparse GPR
training for the moment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weights</strong> (<em>np.array</em>) – weights of the model</p></li>
<li><p><strong>kernel</strong> (<a class="reference internal" href="#rascal.models.Kernel" title="rascal.models.Kernel"><em>Kernel</em></a>) – kernel class used to train the model</p></li>
<li><p><strong>X_train</strong> (<em>SparsePoints</em>) – reference samples used for the training</p></li>
<li><p><strong>self_contributions</strong> (<em>dictionary</em>) – map atomic number to the property baseline, e.g. isolated atoms
energies when the model has been trained on total energies.</p></li>
<li><p><strong>description</strong> (<em>string</em>) – User-defined string used to describe the model for future reference</p></li>
<li><p><strong>units</strong> (<em>dict</em>) – Energy and length units used by the model (default: eV and Å (aka AA),
same as used in ASE)</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="rascal.models.KRR.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">managers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">KNM</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rascal/models/krr.html#KRR.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rascal.models.KRR.predict" title="Permalink to this definition"></a></dt>
<dd><p>Predict properties associated with the atomic structures in managers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>managers</strong> (<a class="reference internal" href="#rascal.neighbourlist.structure_manager.AtomsList" title="rascal.neighbourlist.structure_manager.AtomsList"><em>AtomsList</em></a>) – list of atomic structures with already computed features compatible
with representation in kernel</p></li>
<li><p><strong>KNM</strong> (<em>np.array</em><em>, </em><em>optional</em>) – precomputed sparse kernel matrix</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>predictions</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rascal.models.KRR.predict_forces">
<span class="sig-name descname"><span class="pre">predict_forces</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">managers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">KNM</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rascal/models/krr.html#KRR.predict_forces"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rascal.models.KRR.predict_forces" title="Permalink to this definition"></a></dt>
<dd><p>Predict negative gradients w.r.t atomic positions, e.g. forces, associated with the atomic structures in managers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>managers</strong> (<a class="reference internal" href="#rascal.neighbourlist.structure_manager.AtomsList" title="rascal.neighbourlist.structure_manager.AtomsList"><em>AtomsList</em></a>) – list of atomic structures with already computed features compatible
with representation in kernel</p></li>
<li><p><strong>KNM</strong> (<em>np.array</em><em>, </em><em>optional</em>) – precomputed sparse kernel matrix</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>predictions</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="rascal.models.KRR.predict_stress">
<span class="sig-name descname"><span class="pre">predict_stress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">managers</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">KNM</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rascal/models/krr.html#KRR.predict_stress"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rascal.models.KRR.predict_stress" title="Permalink to this definition"></a></dt>
<dd><p>Predict gradients w.r.t cell parameters, e.g. stress, associated with the atomic structures in managers.
The stress is returned using the Voigt order: xx, yy, zz, yz, xz, xy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>managers</strong> (<a class="reference internal" href="#rascal.neighbourlist.structure_manager.AtomsList" title="rascal.neighbourlist.structure_manager.AtomsList"><em>AtomsList</em></a>) – list of atomic structures with already computed features compatible
with representation in kernel</p></li>
<li><p><strong>KNM</strong> (<em>np.array</em><em>, </em><em>optional</em>) – precomputed sparse kernel matrix</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>predictions</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rascal.models.compute_KNM">
<span class="sig-prename descclassname"><span class="pre">rascal.models.</span></span><span class="sig-name descname"><span class="pre">compute_KNM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">frames</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">X_sparse</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kernel</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">soap</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rascal/models/krr.html#compute_KNM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rascal.models.compute_KNM" title="Permalink to this definition"></a></dt>
<dd><p>Compute GAP kernel of the (new) structures against the sparse points</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>frames</strong> – New structures to compute kernel for</p></li>
<li><p><strong>representation</strong> – RepresentationCalculator to use for the structures</p></li>
<li><p><strong>X_sparse</strong> – Sparse points to compute kernels against</p></li>
<li><p><strong>kernel</strong> – Kernel object to use</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>K_NM</strong> – Summed total-energy kernel stacked with the atom-position gradient of the kernel</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.array</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This function can take quite a long time to run.  To get a progress bar,
you can wrap the <cite>frames</cite> parameter in a <a class="reference internal" href="#tqdm" id="id8"><span>[tqdm]</span></a> object like this:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tqdm.notebook</span> <span class="kn">import</span> <span class="n">tqdm</span> <span class="c1"># for Jupyter</span>
<span class="c1">#from tqdm import tqdm # on the command line</span>
<span class="n">K_NM</span> <span class="o">=</span> <span class="n">compute_KNM</span><span class="p">(</span>
    <span class="n">tqdm</span><span class="p">(</span><span class="n">frames</span><span class="p">,</span> <span class="n">desc</span><span class="o">=</span><span class="s2">&quot;compute KNM&quot;</span><span class="p">,</span> <span class="n">leave</span><span class="o">=</span><span class="kc">False</span><span class="p">),</span>
    <span class="n">X_sparse</span><span class="p">,</span>
    <span class="n">kernel</span><span class="p">,</span>
    <span class="n">soap</span>
<span class="p">)</span>
</pre></div>
</div>
<dl class="citation">
<dt class="label" id="tqdm"><span class="brackets"><a class="fn-backref" href="#id8">tqdm</a></span></dt>
<dd><p><a class="reference external" href="https://github.com/tqdm/tqdm">https://github.com/tqdm/tqdm</a></p>
</dd>
</dl>
</dd></dl>

<section id="filters">
<span id="id9"></span><h3>Filters<a class="headerlink" href="#filters" title="Permalink to this headline"></a></h3>
<p>Filters are used mainly to select rows and columns from feature (or kernel)
matrices in order to reduce their dimensionality and make the fitting problem
tractable, or just more efficient.  The following filters, implemented in
<a class="reference external" href="https://scikit-cosmo.readthedocs.io/en/latest/selection.html">scikit-cosmo (outbound)</a>, are available:</p>
<dl class="py class">
<dt class="sig sig-object py" id="rascal.utils.FPSFilter">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">rascal.utils.</span></span><span class="sig-name descname"><span class="pre">FPSFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">representation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nselect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sample</span> <span class="pre">per</span> <span class="pre">species'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selector_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rascal/utils/filter.html#FPSFilter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rascal.utils.FPSFilter" title="Permalink to this definition"></a></dt>
<dd><dl class="py method">
<dt class="sig sig-object py" id="rascal.utils.FPSFilter.get_fps_distances">
<span class="sig-name descname"><span class="pre">get_fps_distances</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rascal/utils/filter.html#FPSFilter.get_fps_distances"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rascal.utils.FPSFilter.get_fps_distances" title="Permalink to this definition"></a></dt>
<dd><p>Return the Hausdorff distances over the course of selection</p>
<p>This may be a useful (rough) indicator for choosing how many points to
select, as a small distance generally indicates that the selected point
is close to the existing set of selected points and therefore probably
does not add much additional information.</p>
<p>Returns either an array of Hausdorff distances, or a species-indexed
dict of arrays (for the “sample per species” mode).</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="rascal.utils.CURFilter">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">rascal.utils.</span></span><span class="sig-name descname"><span class="pre">CURFilter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">representation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nselect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sample</span> <span class="pre">per</span> <span class="pre">species'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selector_args</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rascal/utils/filter.html#CURFilter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rascal.utils.CURFilter" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<p>Both inherit the interface of the following base class:</p>
<dl class="py class">
<dt class="sig sig-object py" id="rascal.utils.filter.Filter">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">rascal.utils.filter.</span></span><span class="sig-name descname"><span class="pre">Filter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">representation</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">Nselect</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selector</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">act_on</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sample</span> <span class="pre">per</span> <span class="pre">species'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rascal/utils/filter.html#Filter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rascal.utils.filter.Filter" title="Permalink to this definition"></a></dt>
<dd><p>A super class for filtering representations based upon a standard
sample or feature selection class.</p>
<p>This is mainly a wrapper around selectors (implemented e.g. in
scikit-cosmo) that handles the semantic-index transformations
required after selection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>representation</strong> (<em>Calculator</em>) – Representation calculator associated with the kernel</p></li>
<li><p><strong>Nselect</strong> (<em>int</em>) – number of points to select. If act_on=’sample per species’ then it should
be a dictionary mapping atom type to the number of samples, e.g.
Nselect = {1:200,6:100,8:50}.</p></li>
<li><p><strong>selector</strong> (<em>selector to use for filtering. The selector should</em>) – have a <cite>fit</cite> function, which when called will select from the input
matrix the desired features / samples and a <cite>get_support</cite> function
which takes parameters <cite>indices</cite> and <cite>ordered</cite>, and returns a list
of selection indices, in the order that they were selected,
when <cite>indices=True</cite> and <cite>ordered=True</cite>.</p></li>
<li><p><strong>act_on</strong> (<em>string</em>) – Select how to apply the selection. Can be either of ‘sample’,
‘sample per species’,’feature’.  Default ‘sample per species’.
Note that for ‘feature’ mode only the SphericalInvariants
representation is supported.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="io">
<h2>IO<a class="headerlink" href="#io" title="Permalink to this headline"></a></h2>
<p>Utilities for loading and saving Rascal objects (especially models)</p>
<dl class="py function">
<dt class="sig sig-object py" id="rascal.utils.dump_obj">
<span class="sig-prename descclassname"><span class="pre">rascal.utils.</span></span><span class="sig-name descname"><span class="pre">dump_obj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">version</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'0.1'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rascal/utils/io.html#dump_obj"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rascal.utils.dump_obj" title="Permalink to this definition"></a></dt>
<dd><p>Save a python object that inherits from the BaseIO class</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fn</strong> (<em>string</em>) – path to save instance</p></li>
<li><p><strong>instance</strong> (<em>class</em>) – python object that inherits from the BaseIO class</p></li>
<li><p><strong>version</strong> (<em>string</em><em>, </em><em>optional</em>) – serialization version to use, by default CURRENT_VERSION</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>RuntimeError</strong> – When instance does not inherit from BaseIO</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="rascal.utils.load_obj">
<span class="sig-prename descclassname"><span class="pre">rascal.utils.</span></span><span class="sig-name descname"><span class="pre">load_obj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fn</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/rascal/utils/io.html#load_obj"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rascal.utils.load_obj" title="Permalink to this definition"></a></dt>
<dd><p>Load a python object from a file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>fn</strong> (<em>string</em>) – path to the file describing the saved object</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>python class that inherits from BaseIO</p>
</dd>
</dl>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="rascal.utils.BaseIO">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">rascal.utils.</span></span><span class="sig-name descname"><span class="pre">BaseIO</span></span><a class="reference internal" href="../_modules/rascal/utils/io.html#BaseIO"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#rascal.utils.BaseIO" title="Permalink to this definition"></a></dt>
<dd><p>Interface of a Python class serializable by to_dict()</p>
<p>It corresponds to 3 methods:</p>
<ul class="simple">
<li><p>_get_init_params is expected to return a dictionary containing all the</p></li>
</ul>
<p>parameters used by the __init__() methods.</p>
<ul class="simple">
<li><p>_get_data is expected to return a dictionary containing all the data</p></li>
</ul>
<p>that is not set by the initialization of the class.</p>
<ul class="simple">
<li><p>_set_data is expected to set the data that has been extracted by _get_data</p></li>
</ul>
<p>The underlying c++ objects are not pickle-able so deepcopy does not work out
of the box. This class provides an override of the __deepcopy__() function
so that classes that inherit from this base class can be deepcopied.</p>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="index.html" class="btn btn-neutral float-left" title="API reference" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cpp.html" class="btn btn-neutral float-right" title="C++ documentation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019, Chiheb Ben Mahmoud, Michele Ceriotti, Federico Giberti,
Klim Goldshtein, Till Junge, Markus Stricker, Félix Musil, Max Veit.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>